//! Method, error and parameter types for the Analytics endpoint.
#![allow(
    unused_imports,
)]
/* 
 * Generated by: https://github.com/swagger-api/swagger-codegen.git
 */


use crate::{
    BaseOption, BaseRequest, Praiya, PaginatedResponse, PaginationQueryComponent,
    SingleResponse, SubSystem, DEFAULT_PAGERDUTY_API_LIMIT
};
use crate::errors::Error;
use crate::models::*;

use std::collections::HashMap;
use std::sync::Arc;

use futures_core::Stream;
use futures_util::stream::StreamExt;
use http::request::Builder;
use hyper::{Body, Method};
use serde::{Deserialize, Serialize};
use serde_json::value::Value;
use url::form_urlencoded;

pub struct AnalyticsClient {
    pub(crate) api_endpoint: String,
    pub(crate) workspace: String,
    pub(crate) client: Praiya,
}



impl AnalyticsClient {
    /// ---
    ///
    /// # Get raw data - multiple incidents
    ///
    /// Provides enriched incident data and metrics for multiple incidents.
    /// 
    /// Example metrics include Seconds to Resolve, Seconds to Engage, Snoozed Seconds, Sleep Hour Interruptions. Some metric definitions can be found in our knowledge base: https://support.pagerduty.com/docs/pagerduty-analytics
    /// 
    /// <!-- theme: warning -->
    /// > ### Early Access
    /// > This endpoint is in Early Access and may change at any time. You must pass in the X-EARLY-ACCESS header to access it.
    /// <!-- theme: info -->
    /// > A `team_ids` or `service_ids` filter is required for [user-level API keys](https://support.pagerduty.com/docs/using-the-api#section-generating-a-personal-rest-api-key) or keys generated through an OAuth flow. Account-level API keys do not have this requirement.
    /// 
    /// 
    /// ---
    pub async fn get_analytics_incidents(&self, body: GetAnalyticsIncidents) -> Result<, Error> {
        let uri = Praiya::parse_url(&self.api_endpoint, "/analytics/raw/incidents", "")?;
            
        let req = self.client.build_request(
            uri,
            Builder::new().method(Method::POST),
            Praiya::serialize_payload(body)?);


        self.client
            .process_into_value::<, AnalyticsGetAnalyticsIncidentsResponse>(req)
            .await
    }

    /// ---
    ///
    /// # Get raw data - single incident
    ///
    /// Provides enriched incident data and metrics for a single incident.
    /// 
    /// Example metrics include Seconds to Resolve, Seconds to Engage, Snoozed Seconds, Sleep Hour Interruptions. Some metric definitions can be found in our knowledge base: https://support.pagerduty.com/docs/pagerduty-analytics
    /// 
    /// <!-- theme: warning -->
    /// > ### Early Access
    /// > This endpoint is in Early Access and may change at any time. You must pass in the X-EARLY-ACCESS header to access it.
    /// 
    /// 
    /// ---
    pub async fn get_analytics_incidents_by_id(&self, id: &str) -> Result<, Error> {
        let uri = Praiya::parse_url(&self.api_endpoint, &format!("/analytics/raw/incidents/{}", &id), "")?;
            
        let req = self.client.build_request(
            uri,
            Builder::new().method(Method::GET),
            Body::empty());


        self.client
            .process_into_value::<, AnalyticsGetAnalyticsIncidentsByIdResponse>(req)
            .await
    }

    /// ---
    ///
    /// # Get aggregated incident data
    ///
    /// Provides aggregated enriched metrics for incidents.
    /// 
    /// The provided metrics are aggregated by day, week, month using the aggregate_unit parameter, or for the entire period if no aggregate_unit is provided.
    /// 
    /// <!-- theme: warning -->
    /// > ### Early Access
    /// > This endpoint is in Early Access and may change at any time. You must pass in the X-EARLY-ACCESS header to access it.
    /// <!-- theme: info -->
    /// > A `team_ids` or `service_ids` filter is required for [user-level API keys](https://support.pagerduty.com/docs/using-the-api#section-generating-a-personal-rest-api-key) or keys generated through an OAuth flow. Account-level API keys do not have this requirement.
    /// 
    /// 
    /// ---
    pub async fn get_analytics_metrics_incidents_all(&self, body: GetAnalyticsMetricsIncidentsAll) -> Result<, Error> {
        let uri = Praiya::parse_url(&self.api_endpoint, "/analytics/metrics/incidents/all", "")?;
            
        let req = self.client.build_request(
            uri,
            Builder::new().method(Method::POST),
            Praiya::serialize_payload(body)?);


        self.client
            .process_into_value::<, AnalyticsGetAnalyticsMetricsIncidentsAllResponse>(req)
            .await
    }

    /// ---
    ///
    /// # Get aggregated service data
    ///
    /// Provides aggregated metrics for incidents aggregated into units of time by service.
    /// 
    /// Example metrics include Seconds to Resolve, Seconds to Engage, Snoozed Seconds, Sleep Hour Interruptions. Some metric definitions can be found in our knowledge base: https://support.pagerduty.com/docs/pagerduty-analytics
    /// Data can be aggregated by day, week or month in addition to by service, or provided just as a collection of aggregates for each service in the dataset for the entire period.  If a unit is provided, each row in the returned dataset will include a 'range_start' timestamp.
    /// 
    /// <!-- theme: warning -->
    /// > ### Early Access
    /// > This endpoint is in Early Access and may change at any time. You must pass in the X-EARLY-ACCESS header to access it.
    /// <!-- theme: info -->
    /// > A `team_ids` or `service_ids` filter is required for [user-level API keys](https://support.pagerduty.com/docs/using-the-api#section-generating-a-personal-rest-api-key) or keys generated through an OAuth flow. Account-level API keys do not have this requirement.
    /// 
    /// 
    /// ---
    pub async fn get_analytics_metrics_incidents_service(&self, body: GetAnalyticsMetricsIncidentsService) -> Result<, Error> {
        let uri = Praiya::parse_url(&self.api_endpoint, "/analytics/metrics/incidents/services", "")?;
            
        let req = self.client.build_request(
            uri,
            Builder::new().method(Method::POST),
            Praiya::serialize_payload(body)?);


        self.client
            .process_into_value::<, AnalyticsGetAnalyticsMetricsIncidentsServiceResponse>(req)
            .await
    }

    /// ---
    ///
    /// # Get aggregated team data
    ///
    /// Provides aggregated metrics for incidents aggregated into units of time by team.
    /// 
    /// Example metrics include Seconds to Resolve, Seconds to Engage, Snoozed Seconds, Sleep Hour Interruptions. Some metric definitions can be found in our knowledge base: https://support.pagerduty.com/docs/pagerduty-analytics
    /// Data can be aggregated by day, week or month in addition to by team, or provided just as a collection of aggregates for each team in the dataset for the entire period.  If a unit is provided, each row in the returned dataset will include a 'range_start' timestamp.
    /// 
    /// <!-- theme: warning -->
    /// > ### Early Access
    /// > This endpoint is in Early Access and may change at any time. You must pass in the X-EARLY-ACCESS header to access it.
    /// <!-- theme: info -->
    /// > A `team_ids` or `service_ids` filter is required for [user-level API keys](https://support.pagerduty.com/docs/using-the-api#section-generating-a-personal-rest-api-key) or keys generated through an OAuth flow. Account-level API keys do not have this requirement.
    /// 
    /// 
    /// ---
    pub async fn get_analytics_metrics_incidents_team(&self, body: GetAnalyticsMetricsIncidentsTeam) -> Result<, Error> {
        let uri = Praiya::parse_url(&self.api_endpoint, "/analytics/metrics/incidents/teams", "")?;
            
        let req = self.client.build_request(
            uri,
            Builder::new().method(Method::POST),
            Praiya::serialize_payload(body)?);


        self.client
            .process_into_value::<, AnalyticsGetAnalyticsMetricsIncidentsTeamResponse>(req)
            .await
    }

}
